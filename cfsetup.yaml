everything: &everything
  build:
    builddeps: &deps
      - rust
    pre-cache-copy-paths: &paths
      - engine/Cargo.toml
      - ffi/Cargo.toml
      - Cargo.lock
      - Cargo.toml
      - cfsetup-cargo.sh
    pre-cache:
      - ./cfsetup-cargo.sh prebuild --release
    post-cache:
      - sudo ./cfsetup-cargo.sh build --release
  test:
    builddeps: *deps
    pre-cache-copy-paths: *paths
    pre-cache:
      - ./cfsetup-cargo.sh prebuild
    post-cache:
      - sudo ./cfsetup-cargo.sh test
jessie: *everything
stretch: *everything
